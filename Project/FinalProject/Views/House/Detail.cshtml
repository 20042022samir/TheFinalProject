  <link rel="stylesheet" href="~/Assets/CSS/Detail.css">
  <link rel="stylesheet" href="~/Assets/CSS/DetailCarousel.css">
  <script src="https://kit.fontawesome.com/ea89281bc3.js" crossorigin="anonymous"></script>



  @model DetailHouseViewModel
  <style>
      img{
          margin:0;
      }

      media screen and (max-width: 1190px)
       #section2Container img {
       width: 100%;
      }
      @@media (min-width: 0) {
    .g-mr-15 {
        margin-right: 1.07143rem !important;
    }
}
@@media (min-width: 0){
    .g-mt-3 {
        margin-top: 0.21429rem !important;
    }
}

.g-height-50 {
    height: 50px;
}

.g-width-50 {
    width: 50px !important;
}

@@media (min-width: 0){
    .g-pa-30 {
        padding: 2.14286rem !important;
    }
}

.g-bg-secondary {
    background-color: #fafafa !important;
}

.u-shadow-v18 {
    box-shadow: 0 5px 10px -6px rgba(0, 0, 0, 0.15);
}

.g-color-gray-dark-v4 {
    color: #777 !important;
}

.g-font-size-12 {
    font-size: 0.85714rem !important;
}

.media-comment {
    margin-top:20px
}

    #formContainer{
        width:1190px;
    }
  @@media screen and (max-width:1190px){
      #comments{
          width:890px;
          margin:auto;
      }
      #message{
          width:400px;
          margin:0px;
      }
      
      fieldset{
          width:890px;
      }
      form{
          width:890px;
      }
      #formContainer{
          width:890px;
      }
  }
  @@media screen and (max-width:890px){
        #comments {
            width: 380px;
            margin: auto;
        }
         #message{
          width:200px;
          margin:0px;
      }

        fieldset {
            width: 380px;
        }

        form {
            width: 380px;
        }
        #formContainer{
            width:380px;
        }
  }

    @@media screen and (max-width:380px) {
        #comments {
            width: 280px;
            margin: auto;
        }

        #message {
            width: 150px;
            margin: 0px;
        }

        fieldset {
            width: 280px;
        }

        form {
            width: 280px;
        }

        #formContainer {
            width: 280px;
        }
    }
  </style>



 @if(Model.house.ForSale==true)
 {

    <h2 style="text-align:center;color:red;">Alis Ucun Elan</h2>
    @if (Model.house.Typee != null)
    {
        <h2 style="color:red;text-align:center;">@Model.house.Typee.Name</h2>
    }
}
else
{
    <h2 style="text-align:center;color:red;">Kira Ucun Elan</h2>
    @if (Model.house.Typee != null)
    {
        <h2 style="color:red;text-align:center;">@Model.house.Typee.Name</h2>
    }
}
@if (User.Identity.IsAuthenticated)
{   
@if(User.IsInRole("Admin") || User.IsInRole("SuperAdmin")){
    <h2 style="text-align:center;cursor:pointer;">

            <a asp-controller="house" asp-action="deletebyadminshow" asp-route-id="@Model.house.Id"
                style="color:red;text-decoration:none;text-align:center;"><i class="fa-solid fa-trash" style="color: #de1717;"></i></a>
    </h2>
}
}

<style>
    #makePremiumModal {
        padding: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        row-gap: 10px;
        border: 3px solid black;
        border-radius: 10px;
        width: 40%;
        position: fixed;
        z-index: 99;
        background-color: white;
        left: 50%;
        transform: translateX(-50%);
        color: black;
        top: 30%;
    }

    #buttoonModalPremium {
        display: flex;
        flex-direction: row;
        column-gap: 10px;
    }

        #buttoonModalPremium a {
            padding: 6px 10px;
            border: 2px solid black;
            text-decoration: none;
        }

            #buttoonModalPremium a:first-child {
                background-color: green;
                color: white;
            }

            #buttoonModalPremium a:last-child {
                background-color: red;
                color: white;
            }
</style>

@if(Model.house.AppUser.UserName==User.Identity.Name && Model.house.IsPremium==false){
<div style="display:flex;justify-content:center;">
        <a id="makePremium" style="padding:5px 9px;text-decoration:none;color:white;background-color:#B1924C;cursor:pointer;">Elani Premium Et</a>
</div>
}
@if (Model.house.IsPremium == true)
{
    <div style="margin:auto;display:flex;justify-content:center;align-items:center;">
    <img src="~/Assets/Images/asa.png" style="width:100px;"/>
    <h3 style="color:black;">Premium Elan</h3>
    </div>
}


<div id="makePremiumModal"  style="display:none;">
    <img src="~/Assets/Images/asa.png" style="width: 200px;" />
    <h3>Elani Premium Etmek Isteyirsiniz?</h3>
    <div id="buttoonModalPremium">
        <a asp-controller="house" asp-action="makepremium" asp-route-houseId="@Model.house.Id">Beli</a>
        <button id="closeBtn" style="border: none;">
            <a href="#">Xeyr</a>
        </button>
    </div>
</div>

<!--section 1-->
<section id="section1">
    <div id="section1Container">
        <div id="section1ContainerLeft">
            <div id="ccarouselll"  >
                <input type="radio" id="image1" name="image" checked>
                <input type="radio" id="image2" name="image">
                <input type="radio" id="image3" name="image">

                <div class="container">
                    <div class="featured-wrapper">
                        <ul class="featured-list" style="padding-left:0px;">
                            @foreach (var item in Model.house.houseImages)
                            {
                                <li>
                                    <figure>
                                        <img src="~/Assets/Images/@item.Image" style="width:100%;height:300px;">
                                    </figure>
                                </li>
                            }
                            
                        </ul>
                        <ul class="arrows" style="padding-left:0px;">
                            <li>
                                <label for="image1"></label>
                            </li>
                            <li>
                                <label for="image2"></label>
                            </li>
                            <li>
                                <label for="image3"></label>
                            </li>
                        </ul>
                        <ul class="dots" style="padding-left:0px;">
                            <li>
                                <label for="image1"></label>
                            </li>
                            <li>
                                <label for="image2"></label>
                            </li>
                            <li>
                                <label for="image3"></label>
                            </li>
                        </ul>
                    </div>
                    <ul class="thumb-list" style="padding-left:0px;">
                       @foreach (var item in Model.house.houseImages)
                        {
                            <li>
                                <label for="image1">
                                    <img src="~/Assets/Images/@item.Image" alt="" style="width:100%;height:140px;" >
                                    <span class="outer">
                                    </span>
                                </label>
                            </li>

                        }                       
                    </ul>
                </div>
            </div>
            <div style="display: flex;flex-direction: column;row-gap: 20px;padding-top: 20px;align-items: center ;">
                <h1 style="color: black;">@Model.house.FullName</h1>
                <p style="width:500px;word-break:break-all; font-size:23px;color:sienna;text-align:center;">@Model.house.Description</p>
                <p><i class="fa-solid fa-location-dot"></i>@Model.house.Adress</p>
            </div>
        </div>
        <div id="section1ContainerRight">
            <div id="priceDetail">
                <p>N @Model.house.Id</p>
                @if (Model.house.ForRent)
                {              
                <p>Qiymet---> @Model.house.Price:AY</p>
                }
                else 
                {
                <p>Qiymet---> @Model.house.Price:Satis</p>
                }
            </div>
            <div id="detailInfo" style="text-align: center;">
                <h2><span style="color: coral;">tarix</span> :@Model.house.CreatedDate.Day- @Model.house.CreatedDate.Month- @Model.house.CreatedDate.Year</h2>
                <h2><span style="color: coral;">Baxis</span> :@Model.house.ViewCount</h2>
                <h2><span style="color: coral;">Otaq Sayi</span> :@Model.house.RoomCount</h2>
                <h2><span style="color: coral;">Sahe</span> : @Model.house.Size</h2>
                @if (Model.house.City != null)
                {
                <h2><span style="color: coral;">Seher</span> :@Model.house.City.Name</h2>
                }
                @if (Model.house.Distinct != null)
                {
                    <h2><span style="color: coral;">Rayon</span> :@Model.house.Distinct.Name</h2>
                }
                @if (Model.house.Metro != null)
                {
                <h2><span style="color: coral;">Metro</span> :@Model.house.Metro.Name</h2>
                }
                @if (Model.house.Country != null)
                {
                    <h2><span style="color: coral;">Olke</span> :@Model.house.Country.Name</h2>
                }
            </div>
            <div id="ownerUser">
                <div>
                    @if (Model.house.AppUser.Image != "")
                    {
                        <img src="~/Assets/Images/@Model.house.AppUser.Image" style="width: 100px;display: inline-block;" />
                    }
                    else
                    {
                        <img src="~/Assets/Images/UserImage.jpg" style="width: 100px;display: inline-block;" />

                    }
                    <h2>@Model.house.AppUser.Name</h2>
                </div>
                <div id="infouser">
                    <div>
                        <i class="fa-solid fa-phone"></i>
                        <a style="color: black;" href="#">+@Model.house.PhoneNumber</a>
                    </div>
                    <div>
                        <i class="fa-solid fa-envelope"></i>
                        <a style="color: black;" href="#">@Model.house.AppUser.Email</a>
                    </div>
                    <div>
                        <i class="fa-brands fa-whatsapp"></i>
                        <a style="color: black;" href="#">+@Model.house.PhoneNumber</a>
                    </div>

                </div>
            </div>
        </div>
    </div>
</section>

<!--Commet Section-->

@if (!Model.house.IsCommentsOpen)
{
<section id="commentSection">

    <div id="formContainer" style="margin: auto;">
        <form id="commentForm" method="post" asp-controller="elan" asp-action="sharecomment" asp-route-houseId="@Model.house.Id" >

            <script>

                function addComment(){
                    fetch(".", {
                        method: 'POST',
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ a: 1, b: 'Textual content' })
                    }).then(res=>res.json()).then(data=>>{

                    }])
                }

            </script>
            <h3 class="pull-left" style="color:black;">Comment Elave Edin</h3>
            <button id="submitBtn" type="submit" class="btn btn-normal pull-right" style="background-color:black;color:white;">Elave Edin</button>
            <fieldset>
                <div class="row">
                    <div class="col-sm-3 col-lg-2 hidden-xs">
                        <img class="img-responsive" src="~/Assets/Images/@ViewBag.UserImage" alt="" style="width:160px;" >
                    </div>
                    <div id="formController" class="form-group col-xs-12 col-sm-9 col-lg-10">
                        <input  class="form-control" asp-for="@Model.Comment.Description" id="message" placeholder="Sizin Commentiniz" required=""></input>
                    </div>
                </div>
            </fieldset>

        </form>
            <button id="hideCommentsBtn" style="padding:5px 7px; border2px solid black;">Commentleri Gizlet</button>
        <div class="col-md-8">
        </div>
        <div id="comments" class="media g-mb-30 media-comment">
            @if (Model.Comments.Count() == 0)
            {
                <div style="color:red;text-align:center;font-size:23px;">Hec Bir Comment Yazilmayib!</div>
            }
            else
            {
            @foreach (var item in Model.Comments)
            {

            <div class="media-body u-shadow-v18 g-bg-secondary g-pa-30">
                
                <div class="g-mb-15">
                            @if (item.AppUser.Name == Model.house.AppUser.Name)
                            {
                                @if (item.AppUser.Image != "")
                                {
                                    
                                <img class="d-flex g-width-50 g-height-50 rounded-circle g-mt-3 g-mr-15" src="~/Assets/Images/@item.AppUser.Image" alt="Image Description">
                                }else
                                {
                                    <img class="d-flex g-width-50 g-height-50 rounded-circle g-mt-3 g-mr-15" src="~/Assets/Images/UserImage.jpg" alt="Image Description">

                                }
                                <span style="color:red;">Elanin Sahibi</span>
                            }
                            else
                            {
                                @if(item.AppUser.Image!=""){

                                <img class="d-flex g-width-50 g-height-50 rounded-circle g-mt-3 g-mr-15" src="~/Assets/Images/@item.AppUser.Image" alt="Image Description">
                                }else
                                {
                                    <img class="d-flex g-width-50 g-height-50 rounded-circle g-mt-3 g-mr-15" src="~/Assets/Images/UserImage.jpg" alt="Image Description">

                                }

                            }

                    <h5 class="h5 g-color-gray-dark-v1 mb-0" style="color:black;">@item.AppUser.Name</h5>
                    <span class="g-color-gray-dark-v4 g-font-size-12">@item.CreatedDate.Day - @item.CreatedDate.Month - @item.CreatedDate.Year</span>
                            @if (item.AppUser.UserName == User.Identity.Name)
                            {
                               <a asp-controller="elan" asp-action="deletecomment" asp-route-id="@item.Id" style="text-decoration:none;color:black;"><i class="fa-solid fa-trash"></i></a>            
                            }
                </div>

                <p>
                    @item.Description
                </p>

                <ul class="list-inline d-sm-flex my-0">
                    <li class="list-inline-item g-mr-20">
                        <a class="u-link-v5 g-color-gray-dark-v4 g-color-primary--hover" href="#!">
                                    <a asp-controller="elan" asp-action="increaselike" asp-route-id="@item.Id" asp-route-houseId="@item.HouseId">
                                        <i class="fa fa-thumbs-up g-pos-rel g-top-1 g-mr-3"></i>
                                    </a>
                        </a>
                                <span>@item.LikeCount</span>

                    </li>
                    <li class="list-inline-item g-mr-20">
                        <a class="u-link-v5 g-color-gray-dark-v4 g-color-primary--hover" href="#!">
                            <i class="fa fa-thumbs-down g-pos-rel g-top-1 g-mr-3"></i>
                            @item.DislikCount
                        </a>
                    </li>
                    <li class="list-inline-item ml-auto">
                        <a class="u-link-v5 g-color-gray-dark-v4 g-color-primary--hover" href="#!">

                                    <button class="replyBtn" style="border: none;background-color: transparent;">
                                        <i class="fa fa-reply g-pos-rel g-top-1 g-mr-3"></i>
                                    <span>@item.ReplyComments.Count()</span>
                                        Reply
                                    </button>
                        </a>
                    </li>
                </ul>
                  <div class="repliedForm" style="display:none;">
                            <form method="post" asp-controller="elan" asp-action="sharereplycomment" asp-route-commentId="@item.Id"  asp-route-houseId="@item.HouseId" >
                <div style="display: flex;align-items: center;column-gap: 10px;">
                                    @if (@ViewBag.UserImage != "")
                                    {
                                        
                                        <img  src="~/Assets/Images/@ViewBag.UserImage" style="width: 60px;border-radius:50%;height:60px;border:2px solid red;" />
                                    }
                                    else
                                    {
                                        <img src="~/Assets/Images/UserImage.jpg" style="width: 60px;border-radius:50%;" />

                                    }
                                    <input type="text" placeholder="share" asp-for="@Model.ReplyComment.Description" style="width: 300px;height: 30px;border-top: none; border:2px solid black;padding-left: 10px;;">
                      <button type="submit" >Share</button>
                   </div>
                            </form>
                            @if (item.ReplyComments.Count() != 0)
                            {
                                <div style="padding-left:40px;">
                                    @foreach (var reply in item.ReplyComments)
                                    {
                                        <div style="display:flex;align-items:center;margin-top:10px;column-gap:10px;">
                                        <div><img src="~/Assets/Images/@reply.AppUser.Image" style="width:60px; border-radius:50%;height:60px;"/></div>
                                        <div style="display:flex;flex-direction:column;row-gap:1px;">
                                          <span style="color:red;">@reply.CreatedDate.Day - @reply.CreatedDate.Month - @reply.CreatedDate.Year</span>
                                                @if (User.Identity.IsAuthenticated)
                                                {
                                     
                                                @if(User.Identity.Name==reply.AppUser.UserName){
                                                    <span>
                                                <a asp-controller="elan" asp-action="deletereplycomment" asp-route-id="@reply.Id" style="text-decoration:none;color:black;" >
                                                    <i class="fa-solid fa-trash"></i>
                                          </a>
</span>
                                                }
                                          }
                                          <div style="display:flex;column-gap:6px;">
                                          <span style="color:blue;">@reply.AppUser.UserName</span>
                                                @if (reply.AppUser.Name == Model.house.AppUser.Name)
                                                {
                                                    <span style="color:red;">Elanin sahibi</span>
                                                }
                                          </div>
                                                <p>@reply.Description</p>
                                        </div>
                                        </div>
                                    }
                                </div>
                            }
                        </div>
            </div>
            }

            }
        </div>
    </div>
    </section>
}
else
{
    <h2 style="color:red;text-align:center;">Elanin Sahibi Commentleri baglayib</h2>
}
<!--section 2-->
<section id="section2" style="padding-top: 50px;">
    <div id="section2Container">
        <div id="section2Up">
            <h2>Benzer Elanlar</h2>
        </div>
        <div id="section2Down">
            @foreach (var item in Model.ExtraHouses)
            {
                <a asp-controller="house" asp-action="detail" asp-route-id="@item.Id" style="text-decoration:none;color:black;">

                <div class="cardPremium">
                    <div class="cardImageContainer">
                        <img src="~/Assets/Images/@item.houseImages.FirstOrDefault(a=>a.IsMain).Image" style="margin:0px;padding:0px;width:100%;">
                    </div>
                    <div style="padding: 20px;">
                        <div class="homePrice">
                            <p><span>M</span> @item.Price/Ay</p>
                            <i class="fa-regular fa-heart"></i>
                        </div>
                        <div class="roomCount">
                            <p>@item.RoomCount otaqli -@item.Size m2</p>
                        </div>
                        <div class="areaAndDate">
                            @if(item.Distinct!=null){

                            <p>@item.Distinct.Name R</p>
                            }
                            @if(item.City!=null){

                            <p>@item.City.Name , @item.CreatedDate.Day-@item.CreatedDate.Month-@item.CreatedDate.Year</p>
                            }
                        </div>
                    </div>
                </div>
                </a>

            }
        </div>
        <a asp-controller="house" asp-action="getallhouses"  style="text-decoration:none;color:white;cursor:pointer;padding:5px 8px;background-color:black;margin-bottom:10px;">Butun Elanlar</a>
        
    </div>
</section>

                        <script>
    const hideCommentsBtn = document.getElementById("hideCommentsBtn");
    const comments = document.getElementById("comments");
    hideCommentsBtn.addEventListener("click",(event)=>{
        if(comments.style.display!='none')
        {
            comments.style.display='none'
        }else{
            comments.style=display='initial'
        }
    })
        
</script>


<script>
    const repliedForms = document.getElementsByClassName("repliedForm");
    const replyBtns = document.getElementsByClassName("replyBtn");
    for (let a = 0; a < replyBtns.length; a++) {
        replyBtns[a].addEventListener("click", () => {
            if (repliedForms[a].style.display === 'none') {
                repliedForms[a].style.display = "initial"
            } else {
                repliedForms[a].style.display = 'none'
            }
        })
    }
</script>

<script>
    const makePremium = document.getElementById("makePremium")
    const closePremiumBtn = document.getElementById("closeBtn");
    const premiumModal = document.getElementById("makePremiumModal")
    closePremiumBtn.addEventListener("click", () => {
        premiumModal.style.display = 'none'
    })
    makePremium.addEventListener("click", () => {
        premiumModal.style.display = 'flex'
    })
</script>